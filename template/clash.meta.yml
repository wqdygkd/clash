# port: 78901
# socks-port: 7891
# redir-port: 7892
# tproxy-port: 7893
mixed-port: 7890
allow-lan: true
bind-address: '*'
mode: rule
log-level: info
external-controller:

proxies:

proxy-groups:
  - { name: '节点选择', type: select, proxies: [自动选择, 全球直连], icon: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/IconSet/rocket_color.svg }
  - { name: 自动选择, type: url-test, proxies: [], url: http://www.gstatic.com/generate_204, interval: 86400, icon: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/IconSet/26a1.svg }
  - { name: 网易云音乐, type: select, proxies: [全球直连,节点选择], icon: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/IconSet/netease-music.svg }
  - { name: QQ音乐, type: select, proxies: [全球直连,节点选择], icon: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/IconSet/qq-music.svg }
  - { name: 抖音, type: select, proxies: [全球直连,节点选择], icon: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/IconSet/douyin.svg }
  - { name: Apple, type: select, proxies: [全球直连,节点选择], icon: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/IconSet/apple.svg }
  - { name: 全球直连, type: select, proxies: [DIRECT], icon: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/IconSet/1f3af.svg }
  - { name: 电报信息, type: select, proxies: [节点选择], icon: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/IconSet/telegram.svg }
  - { name: 全球拦截, type: select, proxies: [REJECT, DIRECT], icon: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/IconSet/block.svg }
  - { name: 漏网之鱼, type: select, proxies: [DIRECT], icon: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/IconSet/fish_color.svg }

rule-providers:
  NetEaseMusic:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/Ruleset/NetEaseMusic.yaml
    path: ./ruleset/NetEaseMusic.yaml
    interval: 86400
  QQMusic:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/Ruleset/QQMusic.yaml
    path: ./ruleset/QQMusic.yaml
    interval: 86400
  DouYin:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/Ruleset/DouYin.yaml
    path: ./ruleset/DouYin.yaml
    interval: 86400
  Apple:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/wqdygkd/clash@main/Ruleset/Apple.yaml
    path: ./ruleset/apple.yaml
    interval: 86400
  ChinaDomain:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Providers/ChinaDomain.yaml
    path: ./ruleset/ChinaDomain.yaml
    interval: 86400
  ChinaIp:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Providers/ChinaIp.yaml
    path: ./ruleset/ChinaIp.yaml
    interval: 86400

rules:
  - RULE-SET,NetEaseMusic,网易云音乐
  - RULE-SET,QQMusic,QQ音乐
  - RULE-SET,DouYin,抖音
  - RULE-SET,Apple,Apple
  - GEOSITE,category-ads-all,全球拦截
  - GEOSITE,private,全球直连
  # - GEOSITE,youtube,节点选择
  # - GEOSITE,google,节点选择
  # - GEOSITE,twitter,节点选择
  # - GEOSITE,pixiv,节点选择
  # - GEOSITE,onedrive,DIRECT
  # - GEOSITE,microsoft@cn,DIRECT
  # - GEOSITE,apple-cn,DIRECT
  - GEOSITE,steam@cn,全球直连
  - GEOSITE,category-games@cn,全球直连
  - GEOSITE,cn,全球直连
  - RULE-SET,ChinaDomain,全球直连
  - RULE-SET,ChinaIp,全球直连
  - GEOSITE,gfw,节点选择

  #GEOIP 规则
  - GEOIP,private,全球直连,no-resolve
  - GEOIP,telegram,电报信息
  - GEOIP,CN,全球直连
  - MATCH,漏网之鱼

tun:
  enable: false
  stack: mixed
  auto-route: true
  auto-redirect: false
  auto-detect-interface: true
  dns-hijack:
    - any:53
  route-exclude-address: []
  mtu: 1500

dns:
  enable: true
  prefer-h3: true
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter: #fakeip 过滤，以下地址不会下发 fakeip 映射用于连接
    - "*"
    - +.lan
    - +.local
    - time.*.com
    - ntp.*.com
    - +.market.xiaomi.com
    - 'geosite:private'
  fake-ip-filter-mode: blacklist #可选 blacklist/whitelist ，默认 blacklist ，whitelist 即只有匹配成功才返回 fake-ip
  use-hosts: false #是否回应配置中的 hosts ，默认 true
  use-system-hosts: true #是否查询系统 hosts ，默认 true
  respect-rules: true #dns 连接遵守路由规则，需配置 proxy-server-nameserver
  default-nameserver: #默认 DNS, 用于解析 DNS 服务器 的域名，必须为 IP, 可为加密 DNS
  - tls://119.28.28.28:853
  - tls://119.29.29.29:853
  - tls://223.5.5.5:853
  - tls://223.5.5.6:853
  nameserver: #默认的域名解析服务器
    - https://8.8.4.4/dns-query
    - https://8.8.8.8/dns-query
    - https://1.1.1.1/dns-query
    - https://1.0.0.1/dns-query
  proxy-server-nameserver: #代理节点域名解析服务器，仅用于解析代理节点的域名，如果不填则遵循 nameserver-policy 、nameserver 和 fallback 的配置
  - tls://119.28.28.28:853
  - tls://119.29.29.29:853
  - tls://223.5.5.5:853
  - tls://223.5.5.6:853
  direct-nameserver: #用于 direct 出口域名解析的 DNS 服务器，如果不填则遵循 nameserver-policy 、nameserver 和 fallback 的配置
    - system
profile:
  store-selected: true
  store-fake-ip: true
geo-auto-update: true
geo-update-interval: 24
geodata-mode: false
geox-url:
  geoip: https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat
  geosite: https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat
  mmdb: https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip.metadb
  asn: https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/GeoLite2-ASN.mmdb
